(this.webpackJsonppwa_try=this.webpackJsonppwa_try||[]).push([[0],{11:function(e,t,n){e.exports={button:"RecordButton_button__IZaY8",Red:"RecordButton_Red__22ynq"}},22:function(e,t,n){},27:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n(1),o=n.n(r),i=n(16),c=n.n(i),s=(n(22),n(4)),d=n(5),u=n(7),p=n(6),l=n(3),h=n.n(l),m=n(10),g=n.n(m),v=n(2),b=n.n(v),f=n(8),j=n(11),R=n.n(j),_=function(e){var t=[R.a.button];return e.recording&&t.push(R.a.Red),Object(a.jsx)("button",{onClick:e.recording?e.stopRecording:e.startRecording,className:t.join(" "),children:Object(a.jsx)("i",{className:"material-icons",children:e.recording?"mic_off":"mic"})})},O={channelCount:1,sampleRate:44100},w=0,y=function(e){Object(u.a)(n,e);var t=Object(p.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={recording:!1,label:""},e.microphonePermission=Object(f.a)(b.a.mark((function t(){var n;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,navigator.mediaDevices.getUserMedia({audio:O});case 3:n=t.sent,e.mediaRecorder=new MediaRecorder(n),e.mediaRecorder.addEventListener("dataavailable",(function(t){var n=new FormData;n.append("file",t.data),fetch("https://biovisualspeech.eu.pythonanywhere.com/postFileWebm/",{headers:{name:t.timecode,segment:w,id:e.props.id,label:e.state.label,gameId:e.props.gameId,"Content-Length":t.data.length},method:"POST",body:n}).then((function(t){t.ok&&t.text().then((function(t){return e.props.sendMessage(t)}))}))})),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),e.mediaRecorder=void 0;case 11:case"end":return t.stop()}}),t,null,[[0,8]])}))),e.startRecording=Object(f.a)(b.a.mark((function t(){return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0!==e.mediaRecorder){t.next=3;break}return t.next=3,e.microphonePermission();case 3:if(void 0!==e.mediaRecorder){t.next=5;break}return t.abrupt("return");case 5:w=0,e.mediaRecorder.start(900),e.setState({recording:!0});case 8:case"end":return t.stop()}}),t)}))),e.stopRecording=function(){void 0!==e.mediaRecorder&&"recording"===e.mediaRecorder.state&&(e.mediaRecorder.stop(),e.setState({recording:!1}))},e}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var e=Object(f.a)(b.a.mark((function e(){var t=this;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:navigator.mediaDevices.getUserMedia({audio:O}).then((function(e){t.mediaRecorder=new MediaRecorder(e),t.mediaRecorder.addEventListener("dataavailable",(function(e){var n=new FormData;n.append("file",e.data),fetch("https://biovisualspeech.eu.pythonanywhere.com/postFileWebm/",{headers:{name:e.timecode,segment:w,id:t.props.id,label:t.state.label,gameId:t.props.gameId,"Content-Length":e.data.length},method:"POST",body:n}).then((function(e){e.ok&&e.text().then((function(e){return t.props.sendMessage(e)}))}))}))})).catch((function(){return t.mediaRecorder=void 0})),this.props.unity.on("GameOver",(function(){t.stopRecording(),t.setState({label:""})})),this.props.unity.on("GameStart",(function(e){if("Menu"===e)t.stopRecording(),t.setState({label:""});else{console.log(e);var n=e.split("_")[1];t.setState({label:n}),t.props.newGame(),t.stopRecording()}}));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return""===this.state.label?null:Object(a.jsx)(_,{recording:this.state.recording,startRecording:this.startRecording,stopRecording:this.stopRecording})}}]),n}(o.a.Component),x=n(29),I=new m.UnityContent("Build/webgl1/game.json","Build/webgl1/UnityLoader.js"),k=function(e){Object(u.a)(n,e);var t=Object(p.a)(n);function n(e){var a;Object(s.a)(this,n),(a=t.call(this,e)).generateUUID=function(){var e=Math.round(10*Math.random());return Object(x.a)().substring(e,e+6)},a.avaliateProduction=function(e){var t=JSON.parse(e);parseInt(t.gameId)===a.state.gameId&&"true"===t.response.toLowerCase()&&(console.log("characterMoves"),I.send("Character","moveCharacter","True"))},a.onClick=function(){I.send("Character","moveCharacter","True")},a.increaseId=function(){a.setState({gameId:a.state.gameId+1})};var r=localStorage.getItem("id");return null===r&&(r=a.generateUUID(),localStorage.setItem("id",r)),a.state={id:r,gameId:0},a}return Object(d.a)(n,[{key:"render",value:function(){return Object(a.jsx)("div",{className:h.a.App,children:Object(a.jsxs)("header",{className:h.a.header,children:[Object(a.jsx)("div",{className:h.a.Unity,children:Object(a.jsx)(g.a,{unityContent:I})}),Object(a.jsxs)("div",{className:h.a.centeredDiv,children:[Object(a.jsx)(y,{sendMessage:this.avaliateProduction,id:this.state.id,unity:I,gameId:this.state.gameId,newGame:this.increaseId}),Object(a.jsx)("p",{className:h.a.p,children:this.state.id})]})]})})}}]),n}(r.Component),C=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,30)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,o=t.getLCP,i=t.getTTFB;n(e),a(e),r(e),o(e),i(e)}))};c.a.render(Object(a.jsx)(k,{}),document.getElementById("root")),C(),"serviceWorker"in navigator&&window.addEventListener("load",(function(){navigator.serviceWorker.register("/sw.js").then((function(e){})).catch((function(e){}))}))},3:function(e,t,n){e.exports={App:"App_App__2EZG_","App-logo":"App_App-logo__3Yx17",header:"App_header__2Wyi5",p:"App_p__1TF4B",Unity:"App_Unity__1ss9n",centeredDiv:"App_centeredDiv__2KJI6"}}},[[27,1,2]]]);
//# sourceMappingURL=main.f56ef0eb.chunk.js.map