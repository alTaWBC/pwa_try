{"version":3,"sources":["Record/RecordButton.module.css","App.module.css","Record/RecordButton.js","recorder.js","App.js","reportWebVitals.js","index.js","serviceWorker.js"],"names":["module","exports","RecordButton","props","buttonClasses","classes","AudioRecorder","recording","push","Red","onClick","stopRecording","startRecording","className","join","SERVER_URL","require","date","Date","count","Rec","state","label","chunks","audios","urls","prepareUnityCommunication","unity","on","changeLabel","message","split","newGame","setState","prepareMicrophone","a","navigator","mediaDevices","getUserMedia","audio","video","stream","mediaRecorder","MediaRecorder","addEventListener","onDataAvailableSafari","onStop","onDataAvailable","data","timecode","url","undefined","alert","size","sendDataToServer","response","ok","text","then","sendMessage","getTime","blob","Blob","type","dataBlob","getMilliseconds","URL","createObjectURL","Audio","location","formData","FormData","append","length","fetch","headers","name","id","segment","gameId","extension","method","body","start","MicrophonePermissionsWereNotGiven","MicrophoneIsNotRecording","stop","playAudio","index","play","createAudios","map","addListener","event","files","Array","from","target","console","log","this","multiple","onChange","e","Component","unityContent","UnityContent","App","generateUUID","startIndex","Math","round","random","v4","substring","avaliateProduction","JSON","parse","parseInt","toLowerCase","send","increaseId","doubleClick","changeId","mouseDown","timeout","setTimeout","_","mouseUp","clearTimeout","prompt","localStorage","setItem","getItem","header","Unity","centeredDiv","p","button","onDoubleClick","onMouseDown","onMouseUp","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","document","getElementById","window","serviceWorker","register","registration","catch","err"],"mappings":"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","file":"static/js/main.e9edba14.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"button\":\"RecordButton_button__IZaY8\",\"Red\":\"RecordButton_Red__22ynq\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"App\":\"App_App__2EZG_\",\"App-logo\":\"App_App-logo__3Yx17\",\"header\":\"App_header__2Wyi5\",\"p\":\"App_p__1TF4B\",\"Unity\":\"App_Unity__1ss9n\",\"centeredDiv\":\"App_centeredDiv__2KJI6\",\"button\":\"App_button__2LSbO\"};","import classes from \"./RecordButton.module.css\";\r\n\r\nconst RecordButton = (props) => {\r\n  let buttonClasses = [classes.AudioRecorder];\r\n  if (props.recording) buttonClasses.push(classes.Red);\r\n  return (\r\n    <button\r\n      onClick={props.recording ? props.stopRecording : props.startRecording}\r\n      className={buttonClasses.join(\" \")}\r\n    >\r\n      <i className=\"material-icons\">{props.recording ? \"mic_off\" : \"mic\"}</i>\r\n    </button>\r\n  );\r\n};\r\n\r\nexport default RecordButton;\r\n","import React, { Component } from \"react\";\r\nimport RecordButton from \"./Record/RecordButton\";\r\nconst ffmpeg = require(\"ffmpeg\");\r\n\r\n// Time between calls to {this.onDataAvailable}\r\nconst timeInterval = 3000;\r\n\r\n// Segment number\r\n\r\nconst SERVER_URL = \"https://biovisualspeech.eu.pythonanywhere.com\";\r\n\r\n// Used for debug purposes\r\n// eslint-disable-next-line no-unused-vars\r\nconst DEBUG_URL = \"http://192.168.1.7:5050\";\r\nconst date = new Date();\r\n\r\nlet count = 0;\r\n\r\nclass Rec extends Component {\r\n    state = {\r\n        recording: false,\r\n        label: \"l\",\r\n        chunks: [],\r\n        audios: [],\r\n        urls: [],\r\n    };\r\n\r\n    componentDidMount() {\r\n        this.prepareMicrophone();\r\n        this.prepareUnityCommunication();\r\n    }\r\n\r\n    prepareUnityCommunication = () => {\r\n        this.props.unity.on(\"GameOver\", () => {\r\n            this.stopRecording();\r\n            this.changeLabel();\r\n        });\r\n        this.props.unity.on(\"GameStart\", (message) => {\r\n            this.stopRecording();\r\n\r\n            // Message can be 'Game_{Label}' or 'Menu'\r\n            // In the former Label will be {Label}\r\n            // In the latter Label will be {undefined}\r\n            // this.changeLabel({label}) uses label === '' in undefined scenarios\r\n            this.changeLabel(message.split(\"_\")[1]);\r\n\r\n            const newGame = message !== \"Menu\";\r\n            if (newGame) this.props.newGame();\r\n        });\r\n    };\r\n\r\n    changeLabel = (label = \"\") => {\r\n        this.setState({ label });\r\n    };\r\n\r\n    prepareMicrophone = async () => {\r\n        const stream = await navigator.mediaDevices.getUserMedia({ audio: true, video: false });\r\n        this.mediaRecorder = new MediaRecorder(stream);\r\n        // const isApple =\r\n        //     window.navigator.platform.includes(\"iPhone\") ||\r\n        //     window.navigator.platform.includes(\"Mac\") ||\r\n        //     window.navigator.platform.includes(\"iPad\");\r\n        this.mediaRecorder.addEventListener(\r\n            \"dataavailable\",\r\n            /*isApple ?*/ this.onDataAvailableSafari //: this.onDataAvailable\r\n        );\r\n        /*isApple &&*/ this.mediaRecorder.addEventListener(\"stop\", this.onStop);\r\n    };\r\n\r\n    onDataAvailable = async ({ data, timecode }, url = undefined) => {\r\n        alert(data.size);\r\n        const response = await this.sendDataToServer(data, timecode, url);\r\n        if (!response.ok) return;\r\n        response.text().then((message) => this.props.sendMessage(message));\r\n    };\r\n\r\n    // Safari handles recording sound in a different light\r\n    // So we need special care\r\n    onDataAvailableSafari = ({ data /*, timecode = date.getTime()*/ }) => {\r\n        // const blob = new Blob([data], { type: \"audio/mp4\" });\r\n        // const url = URL.createObjectURL(blob);\r\n        // const audio = new Audio(url);\r\n        // audio.play();\r\n        // this.onDataAvailable({ data: blob, timecode: timecode }, \"postFileMp4/\");\r\n\r\n        // const dataBlob = new Blob([data], { type: \"audio/mp3\" });\r\n        // this.sendDataToServer(dataBlob, date.getMilliseconds(), \"postFileMp4/\");\r\n\r\n        // dataBlob.arrayBuffer().then((buffer) => {\r\n        //     const alertString = `\r\n        //     Blob size ${dataBlob.size}\r\n        //     Blob type ${dataBlob.type}\r\n        //     Size ${buffer.byteLength}`;\r\n        //     console.log(alertString);\r\n        // });\r\n        // const reader = new FileReader();\r\n        // reader.onload = (event) => {\r\n        //     console.log(event.target.result);\r\n        //     console.log(event.target.result.length);\r\n        //     alert(JSON.stringify(btoa(event.target.result)));\r\n        //     this.sendDataToServer(btoa(event.target.result), date.getTime(), \"postFileMp4/\");\r\n        // }; // data url!\r\n        // reader.readAsBinaryString(dataBlob);\r\n\r\n        const chunks = [...this.state.chunks, data];\r\n        this.setState({ chunks });\r\n    };\r\n\r\n    onStop = ({ data, timecode = date.getTime() }) => {\r\n        let chunks = [...this.state.chunks, data];\r\n        const blob = new Blob(chunks, { type: \"audio/wav\" });\r\n        const dataBlob = new Blob([data], { type: \"audio/mp3\" });\r\n        this.sendDataToServer(dataBlob, date.getMilliseconds(), \"postFileMp4/\");\r\n        // // const fileReader = new FileReader();\r\n        // // fileReader.onload = () => {\r\n        // //     console.log(fileReader.result);\r\n        // //     console.log(fileReader.result.byteLength);\r\n        // //     this.sendDataToServer(fileReader.result, timecode, \"postFileMp4/\");\r\n        // // };\r\n        // // fileReader.readAsArrayBuffer(blob);\r\n        // this.sendDataToServer(blob, timecode, \"postFileMp4/\");\r\n        const url = URL.createObjectURL(blob);\r\n        const audio = new Audio(url);\r\n        const audios = [...this.state.audios, audio];\r\n        chunks = [];\r\n        const urls = [...this.state.urls, url];\r\n\r\n        this.setState({ chunks, audios, urls });\r\n    };\r\n\r\n    sendDataToServer = async (data, timecode, location = \"postFileWebm/\") => {\r\n        const formData = new FormData();\r\n        formData.append(\"file\", data);\r\n        const length = data.length || data.size;\r\n        return fetch(`${SERVER_URL}/${location}`, {\r\n            headers: {\r\n                name: `${this.props.id}${timecode}`,\r\n                segment: count,\r\n                id: this.props.id,\r\n                label: this.state.label,\r\n                gameId: this.props.gameId,\r\n                \"Content-Length\": length,\r\n                extension: \"mp3\",\r\n            },\r\n            method: \"POST\",\r\n            body: formData,\r\n        });\r\n    };\r\n\r\n    startRecording = async () => {\r\n        const MicrophonePermissionsWereNotGiven = this.mediaRecorder === undefined;\r\n        if (MicrophonePermissionsWereNotGiven) return;\r\n\r\n        const MicrophoneIsNotInitialized = this.mediaRecorder === null;\r\n        if (MicrophoneIsNotInitialized) return;\r\n\r\n        this.mediaRecorder.start(timeInterval);\r\n        count = 0;\r\n        this.setState({ recording: true });\r\n    };\r\n\r\n    stopRecording = () => {\r\n        const MicrophonePermissionsWereNotGiven = this.mediaRecorder === undefined;\r\n        const MicrophoneIsNotRecording = !this.state.recording;\r\n        if (MicrophonePermissionsWereNotGiven || MicrophoneIsNotRecording) return;\r\n\r\n        const MicrophoneIsNotInitialized = this.mediaRecorder === null;\r\n        if (MicrophoneIsNotInitialized) return;\r\n\r\n        this.mediaRecorder.stop();\r\n        this.setState({ recording: false });\r\n    };\r\n\r\n    playAudio = (index) => {\r\n        this.state.audios[index].play();\r\n    };\r\n\r\n    createAudios = (audios) => {\r\n        return audios.map((audio, index) => {\r\n            return (\r\n                <div key={index}>\r\n                    {/* <a href={this.state.urls[index]} download={`${index}.wav`}>\r\n                        {index}\r\n                    </a> */}\r\n                    <button onClick={() => audio.play()}></button>\r\n                </div>\r\n            );\r\n        });\r\n    };\r\n\r\n    addListener = (event) => {\r\n        const files = Array.from(event.target.files);\r\n        const url = URL.createObjectURL(files[0]);\r\n        const audio = new Audio(url);\r\n        this.setState({ audios: [...this.state.audios, audio] });\r\n        const data = files[0];\r\n        console.log(data);\r\n        const formData = new FormData();\r\n        formData.append(\"file\", data);\r\n        const length = data.length || data.size;\r\n\r\n        console.log(length);\r\n        fetch(\"https://biovisualspeech.eu.pythonanywhere.com/postFileMp4/\", {\r\n            headers: {\r\n                name: `30000`,\r\n                segment: 0,\r\n                id: \"123456\",\r\n                label: \"l\",\r\n                gameId: \"1\",\r\n                \"Content-Length\": length,\r\n                extension: \"wav\",\r\n            },\r\n            method: \"POST\",\r\n            body: formData,\r\n        });\r\n    };\r\n\r\n    render() {\r\n        try {\r\n            console.log(this.mediaRecorder?.state);\r\n            const audios = this.createAudios(this.state.audios);\r\n            // this.addListener();\r\n\r\n            return this.state.label === \"\" ? null : (\r\n                <div>\r\n                    <RecordButton\r\n                        recording={this.state.recording}\r\n                        startRecording={this.startRecording}\r\n                        stopRecording={this.stopRecording}\r\n                    />\r\n                    {audios}\r\n                    <input type=\"file\" id=\"file-selector\" multiple onChange={this.addListener}></input>\r\n                </div>\r\n            );\r\n        } catch (e) {\r\n            return <div>{e.message}</div>;\r\n        }\r\n    }\r\n}\r\n\r\nexport default Rec;\r\n","import classes from \"./App.module.css\";\nimport Unity, { UnityContent } from \"react-unity-webgl\";\nimport Recorder from \"./recorder\";\nimport React, { Component } from \"react\";\nimport { v4 } from \"uuid\";\n\nconst unityContent = new UnityContent(\"Build/webgl1/game.json\", \"Build/webgl1/UnityLoader.js\");\n// const unityContent = new UnityContent(\"./Build/webgl1/game.json\", \"./Build/webgl1/UnityLoader.js\");\n\nclass App extends Component {\n    generateUUID = () => {\n        const startIndex = Math.round(Math.random() * 10);\n        const id = v4().substring(startIndex, startIndex + 6);\n        return id;\n    };\n\n    constructor(props) {\n        super(props);\n        let id = localStorage.getItem(\"id\");\n        if (id === null) {\n            id = this.generateUUID();\n            localStorage.setItem(\"id\", id);\n        }\n        this.state = {\n            id: id,\n            gameId: 0,\n        };\n    }\n\n    avaliateProduction = (message) => {\n        const response = JSON.parse(message);\n        if (parseInt(response[\"gameId\"]) !== this.state.gameId) return;\n        if (response[\"response\"].toLowerCase() === \"true\") {\n            console.log(\"characterMoves\");\n            unityContent.send(\"Character\", \"moveCharacter\", \"True\");\n        }\n    };\n\n    increaseId = () => {\n        this.setState({ gameId: this.state.gameId + 1 });\n    };\n\n    doubleClick = () => {\n        const id = this.generateUUID();\n        this.changeId(id);\n    };\n\n    mouseDown = () => {\n        const timeout = setTimeout((_) => this.changeId(), 1000);\n        this.setState({\n            timeout: timeout,\n        });\n    };\n\n    mouseUp = () => {\n        clearTimeout(this.state.timeout);\n    };\n\n    changeId = (id) => {\n        console.log(id);\n        if (!id) {\n            id = prompt(\"Qual é o id?\");\n            if (!id || id.length !== 6) {\n                alert(\"Id Inválido! Tente novamente\");\n                return;\n            }\n        }\n        localStorage.setItem(\"id\", id);\n        this.setState({\n            id: id,\n        });\n    };\n\n    render() {\n        return (\n            <div className={classes.App}>\n                <header className={classes.header}>\n                    <div className={classes.Unity}>\n                        <Unity unityContent={unityContent} />\n                    </div>\n                    <div className={classes.centeredDiv}>\n                        <Recorder\n                            sendMessage={this.avaliateProduction}\n                            id={this.state.id}\n                            unity={unityContent}\n                            gameId={this.state.gameId}\n                            newGame={this.increaseId}\n                        />\n                        <p className={classes.p}>\n                            <button\n                                className={classes.button}\n                                onDoubleClick={this.doubleClick}\n                                onMouseDown={this.mouseDown}\n                                onMouseUp={this.mouseUp}\n                            >\n                                {this.state.id}\n                            </button>\n                        </p>\n                    </div>\n                </header>\n            </div>\n        );\n    }\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\nimport { registerServiceWorker } from './serviceWorker'\n\n\nReactDOM.render(\n    <App />,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\nregisterServiceWorker();\n","export const registerServiceWorker = () => {\r\n  if ('serviceWorker' in navigator) {\r\n    window.addEventListener('load', function () {\r\n      navigator.serviceWorker.register('/sw.js').then(function (registration) {\r\n        // Registration was successful\r\n        //console.log('ServiceWorker registration successful with scope: ', registration.scope);\r\n      }).catch(function (err) {\r\n        // registration failed :(\r\n        //console.log('ServiceWorker registration failed: ', err);\r\n      });\r\n    });\r\n  }\r\n}"],"sourceRoot":""}