(this.webpackJsonppwa_try=this.webpackJsonppwa_try||[]).push([[0],{11:function(e,t,n){e.exports={button:"RecordButton_button__IZaY8",Red:"RecordButton_Red__22ynq"}},22:function(e,t,n){},27:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(2),o=n.n(a),i=n(16),c=n.n(i),s=(n(22),n(5)),u=n(6),d=n(8),p=n(7),l=n(3),h=n.n(l),g=n(10),m=n.n(g),b=n(1),f=n.n(b),v=n(4),j=n(11),_=n.n(j),w=function(e){var t=[_.a.button];return e.recording&&t.push(_.a.Red),Object(r.jsx)("button",{onClick:e.recording?e.stopRecording:e.startRecording,className:t.join(" "),children:Object(r.jsx)("i",{className:"material-icons",children:e.recording?"mic_off":"mic"})})},O="https://biovisualspeech.eu.pythonanywhere.com/postFileWebm/",y=function(e){Object(d.a)(n,e);var t=Object(p.a)(n);function n(){var e;Object(s.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).state={recording:!1,label:""},e.prepareUnityCommunication=function(){e.props.unity.on("GameOver",(function(){e.stopRecording(),e.changeLabel()})),e.props.unity.on("GameStart",(function(t){e.stopRecording(),e.changeLabel(t.split("_")[1]),"Menu"!==t&&e.props.newGame()}))},e.changeLabel=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";e.setState({label:t})},e.prepareMicrophone=Object(v.a)(f.a.mark((function t(){var n;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,navigator.mediaDevices.getUserMedia({audio:!0});case 3:n=t.sent,e.mediaRecorder=new MediaRecorder(n),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),e.mediaRecorder=void 0;case 10:case"end":return t.stop()}}),t,null,[[0,7]])}))),e.onDataAvailable=function(){var t=Object(v.a)(f.a.mark((function t(n){var r,a,o;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.data,a=n.timecode,t.next=3,e.sendDataToServer(r,a);case 3:if((o=t.sent).ok){t.next=6;break}return t.abrupt("return");case 6:o.text().then((function(t){return e.props.sendMessage(t)}));case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.sendDataToServer=function(){var t=Object(v.a)(f.a.mark((function t(n,r){var a;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(a=new FormData).append("file",n),t.abrupt("return",fetch(O,{headers:{name:r,id:e.props.id,label:e.state.label,gameId:e.props.gameId,"Content-Length":n.length},method:"POST",body:a}));case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e.startRecording=Object(v.a)(f.a.mark((function t(){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(void 0===e.mediaRecorder)){t.next=3;break}return t.abrupt("return");case 3:e.mediaRecorder.start(3e3),e.setState({recording:!0});case 5:case"end":return t.stop()}}),t)}))),e.stopRecording=function(){var t=void 0===e.mediaRecorder,n=!e.state.recording;t||n||(e.mediaRecorder.stop(),e.setState({recording:!1}))},e}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=Object(v.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.prepareMicrophone(),this.prepareUnityCommunication();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return""===this.state.label?null:Object(r.jsx)(w,{recording:this.state.recording,startRecording:this.startRecording,stopRecording:this.stopRecording})}}]),n}(o.a.Component),I=n(29),x=new g.UnityContent("Build/webgl1/game.json","Build/webgl1/UnityLoader.js"),R=function(e){Object(d.a)(n,e);var t=Object(p.a)(n);function n(e){var r;Object(s.a)(this,n),(r=t.call(this,e)).generateUUID=function(){var e=Math.round(10*Math.random());return Object(I.a)().substring(e,e+6)},r.avaliateProduction=function(e){var t=JSON.parse(e);parseInt(t.gameId)===r.state.gameId&&"true"===t.response.toLowerCase()&&(console.log("characterMoves"),x.send("Character","moveCharacter","True"))},r.increaseId=function(){r.setState({gameId:r.state.gameId+1})},r.doubleClick=function(){var e=r.generateUUID();r.changeId(e)},r.mouseDown=function(){var e=setTimeout((function(e){return r.changeId()}),1e3);r.setState({timeout:e})},r.mouseUp=function(){clearTimeout(r.state.timeout)},r.changeId=function(e){console.log(e),e||(e=prompt("Qual \xe9 o id?"))&&6===e.length?(localStorage.setItem("id",e),r.setState({id:e})):alert("Id Inv\xe1lido! Tente novamente")};var a=localStorage.getItem("id");return null===a&&(a=r.generateUUID(),localStorage.setItem("id",a)),r.state={id:a,gameId:0},r}return Object(u.a)(n,[{key:"render",value:function(){return Object(r.jsx)("div",{className:h.a.App,children:Object(r.jsxs)("header",{className:h.a.header,children:[Object(r.jsx)("div",{className:h.a.Unity,children:Object(r.jsx)(m.a,{unityContent:x})}),Object(r.jsxs)("div",{className:h.a.centeredDiv,children:[Object(r.jsx)(y,{sendMessage:this.avaliateProduction,id:this.state.id,unity:x,gameId:this.state.gameId,newGame:this.increaseId}),Object(r.jsx)("p",{className:h.a.p,children:Object(r.jsx)("button",{className:h.a.button,onDoubleClick:this.doubleClick,onMouseDown:this.mouseDown,onMouseUp:this.mouseUp,children:this.state.id})})]})]})})}}]),n}(a.Component),k=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,30)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,o=t.getLCP,i=t.getTTFB;n(e),r(e),a(e),o(e),i(e)}))};c.a.render(Object(r.jsx)(R,{}),document.getElementById("root")),k(),"serviceWorker"in navigator&&window.addEventListener("load",(function(){navigator.serviceWorker.register("/sw.js").then((function(e){})).catch((function(e){}))}))},3:function(e,t,n){e.exports={App:"App_App__2EZG_","App-logo":"App_App-logo__3Yx17",header:"App_header__2Wyi5",p:"App_p__1TF4B",Unity:"App_Unity__1ss9n",centeredDiv:"App_centeredDiv__2KJI6",button:"App_button__2LSbO"}}},[[27,1,2]]]);
//# sourceMappingURL=main.f52557e3.chunk.js.map